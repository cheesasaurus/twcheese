!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);class i{insertBefore(e){return this._beforeInsert(),$(e).before(this.$el),this}insertAfter(e){return this._beforeInsert(),$(e).after(this.$el),this}appendTo(e){return this._beforeInsert(),$(e).append(this.$el),this}_beforeInsert(){if("function"!=typeof this.afterInsert)return;!function(e,t){let n=new MutationObserver(i=>{e:for(let s of i)for(let i of s.addedNodes)if(i===e||i.contains(e)){setTimeout(t,0),n.disconnect();break e}});n.observe(document,{attributes:!0,childList:!0,subtree:!0})}(this.$el[0],()=>this.afterInsert())}}let s=window.image_base,r=window.TwCheese.ROOT+"/assets/images/",o=s+"popup/border.png",a=r+"sidebar/gear.png",h=r+"sidebar/bug.png",c=r+"sidebar/github.png";function d(e){"string"!=typeof e&&(e=String(e));var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}let u=new Set;function l(e){u.has(e)||($(`<style>${e}</style>`).appendTo("head"),u.add(e))}l(`\n    .twcheese-popup {\n        z-index: 13000;\n        display: block;\n        position: fixed;\n        top: 60px;\n        border: 19px solid #804000;\n        border-image: url(${o}) 19 19 19 19 repeat;\n        left: 50%;\n        -webkit-transform: translateX(-50%);\n        transform: translateX(-50%);\n    }\n`);new Set(["click","mousemove","mouseover","mouseout","mousedown","mouseup"]),new Set(["mousenter","mouseleave","mouseover","mouseout"]);const g={PHASE_COMPLETION_READY:"phase_completion_ready",PHASE_COMPLETION_NOT_READY:"phase_completion_not_ready",PHASE_CHANGED:"phase_changed",QUESTION_ANSWERED:"question_answered",QUESTION_NOT_ANSWERED:"question_not_answered",OPTION_VALUE_CHANGED:"answer_value_changed",BUG_REPORT_SUCCEEDED:"bug_report_succeeded",BUG_REPORT_FAILED:"bug_report_failed",USER_REJECTED:"user_rejected"},p={ATTEMPT:"attempt",QUESTION:"question",REPORT:"report"},b={VALUE:"value",FREE_FORM:"free_form",SELECT:"select"};class m extends i{constructor(e){super(),this.question=e,this.initStructure(e),this.watchSelf()}initStructure(){this.$el=$(this.createHtml().trim()),this.$answers=this.$el.find(".twcheese-debug-question-answer")}createHtml(){let e=[];for(let t=0;t<this.question.options.length;t++){let n=this.question.options[t];e.push(`\n                <div class="twcheese-debug-question-answer ${n.className}" data-index="${t}">\n                    ${n.text}\n                </div>\n            `)}switch(this.question.getType()){case b.FREE_FORM:return this._createHtmlQuestionFreeForm();case b.VALUE:return this._createHtmlQuestionAboutValue(e);case b.SELECT:return this._createHtmlQuestionSelect(e);default:throw Error("unrecognized question type")}}_createHtmlQuestionSelect(e){return`\n            <div class="twcheese-debug-question">\n                <div class="twcheese-debug-question-text">${this.question.text}</div>\n                <hr/>\n                ${e.join("")}\n            </div>\n        `}_createHtmlQuestionFreeForm(){let e=this.question.options[0];return`\n            <div class="twcheese-debug-question">\n                <div class="twcheese-debug-question-text">${this.question.text}</div>\n                <hr/>\n                <textarea\n                    placeholder="${d(e.text)}"\n                    class="twcheese-debug-question-answer ${e.className}"\n                    data-index="0"\n                >${d(e.value)}</textarea>\n            </div>\n        `}_createHtmlQuestionAboutValue(e){let t=this.createHtmlForValue(this.question.value);return`\n            <div class="twcheese-debug-question">\n                <div class="twcheese-debug-question-text">${this.question.text}</div>\n                <hr/>\n                <div class="twcheese-debug-question-content">\n                    <div class="twcheese-debug-question-value">${t}</div>\n                    <div style="padding-left: 10px;">${e.join("")}</div>\n                </div>                \n            </div>\n        `}createHtmlForValue(e){return null==e?'<span class="non-existent">non-existent</span>':"function"==typeof e.toDebugString?d(e.toDebugString()):"object"==typeof e?Object.entries(e).map(e=>{let[t,n]=e;return`<div class="twcheese-debug-value-iter">\n                    <div class="key">${this.createLabelForValue(n,t)}</div>\n                    <div class="value">${this.createHtmlForValue(n)}</div>\n                </div>`}).join(""):d(e.toString())}createLabelForValue(e,t){return"function"==typeof e.imageSrc?`<image src="${e.imageSrc()}" />`:t}watchSelf(){this.question.getType()!==b.FREE_FORM?this.$answers.on("click",e=>{this.$answers.removeClass("active");let t=$(e.target).addClass("active");this.question.setSelectedOption(t.data("index"))}):this.$answers.on("input",e=>{let t=$(e.target);this.question.options[0].setValue(t.val())})}}l("\n    .twcheese-debug-question {\n        margin-bottom: 40px;\n    }\n\n    .twcheese-debug-question-text {\n        font-size: 13px;\n        font-weight: 700;\n        color: rgb(200, 200, 200);\n    }\n\n    .twcheese-debug-question hr {\n        height: 1px;\n        background-color: white;\n        border: none;\n        opacity: 0.2;\n    }\n\n    .twcheese-debug-question-content {\n        display: flex;\n        justify-content: space-between;        \n        align-items: center;\n    }\n\n    .twcheese-debug-question-value {\n        line-height: 20px;\n    }\n    .twcheese-debug-question-value img {\n        vertical-align: middle;\n    }\n\n    .twcheese-debug-question-value .non-existent {\n        font-style: italic;\n    }\n\n    .twcheese-debug-question-answer {\n        margin: 10px 0;\n        background-color: rgb(23, 23, 23);\n        border: 1px solid rgb(75, 75, 75);\n        height: 30px;\n        border-radius: 15px;\n        line-height: 30px;\n        white-space: nowrap;\n        padding: 0 10px;\n        text-align: center;\n        cursor: pointer;\n    }\n    .twcheese-debug-question-answer:hover {\n        border-color: rgb(150, 150, 150);\n    }\n    .twcheese-debug-question-answer.active {\n        border-color: darkOrange;\n        background-color: black;\n    }\n    \n    .twcheese-debug-question-answer.correct {\n        border-color: rgb(0, 70, 0);\n    }\n    .twcheese-debug-question-answer.correct:hover {\n        border-color: rgb(0, 100, 0);\n    }\n    .twcheese-debug-question-answer.correct.active {\n        border-color: rgb(0, 150, 0);\n    }\n\n    .twcheese-debug-question-answer.incorrect {\n        border-color: rgb(100, 0, 0);\n    }\n    .twcheese-debug-question-answer.incorrect:hover {\n        border-color: rgb(175, 0, 0);\n    }\n    .twcheese-debug-question-answer.incorrect.active {\n        border-color: rgb(250, 0, 0);\n    }\n\n    .twcheese-debug-question-answer.free-form {\n        border: 1px solid rgb(75, 75, 75);\n        border-radius: 3px;\n        white-space: pre-wrap;\n        color: inherit;\n        padding: 2px 5px;\n        text-align: left;\n        line-height: normal;\n        height: 120px;\n        width: calc(100% - 6px);\n        resize: vertical;\n        cursor: text;\n    }\n\n    .twcheese-debug-value-iter {\n        display: flex;\n    }\n    .twcheese-debug-value-iter > div:nth-child(2) {\n        padding-left: 5px;\n    }\n\n");class w extends i{constructor(e){super(),this.phase=e,this.initStructure(),this.watchSelf(),this.$abort.hide()}initStructure(){this.$el=$(this.createHtml().trim()),this.$abort=this.$el.find(".twcheese-debug-attempt-abort")}createHtml(){return this.phase.instructions?this.createHtmlForUserInteraction():this.createHtmlForAutoAttempt()}createHtmlForUserInteraction(){return`\n            <div class="twcheese-debug-attempt">\n                <p>${this.phase.instructions}</p>\n                <div style="text-align: center;">\n                    <div class="twcheese-debug-attempt-abort">Can't do it</div>\n                </div>\n            </div>\n        `}createHtmlForAutoAttempt(){return`\n            <div class="twcheese-debug-attempt">\n                Standby for <i>${this.phase.name}</i>.\n            </div>\n        `}watchSelf(){this.$abort.on("click",()=>this.phase.userAbort())}appendTo(e){return setTimeout(()=>this.showAbortButton(),1e4),super.appendTo(e)}showAbortButton(){this.$abort.show(),$(this).trigger("change")}}l("\n    .twcheese-debug-attempt-abort {\n        display: inline-block;\n        margin: 10px 0;\n        background-color: rgb(23, 23, 23);\n        border: 1px solid rgb(75, 75, 75);\n        height: 30px;\n        border-radius: 15px;\n        line-height: 30px;\n        white-space: nowrap;\n        padding: 0 10px;\n        text-align: center;\n        cursor: pointer;\n    }\n    .twcheese-debug-attempt-abort:hover {\n        border-color: rgb(150, 150, 150);\n    }   \n");class f extends i{constructor(e){super(),this.phase=e,this.initStructure(),this.watchPhase()}initStructure(){this.$el=$(this.createHtml().trim())}createHtml(){return'<div class="twcheese-debug-report"><i>Submitting report...</i></div>'}watchPhase(){$(this.phase).on(g.BUG_REPORT_SUCCEEDED,e=>{this.$el.html("<p>Bug reported!</p>")})}}l("\n    .twcheese-debug-report {\n        min-height: 200px;\n    }    \n");class v extends i{constructor(){super(),this.initStructure(),this.watchSelf(),this.watchGlobal(),this.process=null}initStructure(){this.$el=$(this.createHtml().trim()),this.$header=this.$el.find(".twcheese-debugger-header"),this.$content=this.$el.find(".twcheese-debugger-content"),this.$nav=this.$el.find(".twcheese-debugger-nav"),this.$next=this.$el.find(".twcheese-debugger-next"),this.$processName=this.$el.find(".twcheese-debugger-process-name"),this.$inspector=this.$el.find(".twcheese-debugger-inspector"),this.$iframe=this.$inspector.find("iframe"),this.$iframeOverlay=this.$inspector.find(".iframe-overlay")}createHtml(){return'\n            <div class="twcheese-debugger">\n                <div>\n                    <div class="twcheese-debugger-header">\n                        <div>REPORT A BUG</div>\n                        <div class="twcheese-debugger-process-name"></div>\n                    </div>\n                    <div class="twcheese-debugger-content">blah bla blucci</div>\n                    <div class="twcheese-debugger-nav">\n                        <div class="twcheese-debugger-next"></div>\n                    </div>\n                </div>\n                <div class="twcheese-debugger-inspector">\n                    <iframe scrolling="no"></iframe>\n                    <div class="iframe-overlay"></div>\n                </div>\n            </div>\n        '}watchSelf(){this.$next.on("click",()=>{this.process.goToNextPhase()})}watchGlobal(){$(window).on("resize",()=>this.updateScrolling())}startProcessForLastUsedToolIfSensible(){this.process||this.startProcess(window.TwCheese.newDebugProcess(TwCheese.lastToolUsedId))}startProcess(e){this.$next.hide(),this.process=e,this.$processName.text(e.name),$(e).on(g.PHASE_COMPLETION_READY,()=>{this.process.hasNextPhase()&&this.$next.show()}),$(e).on(g.PHASE_COMPLETION_NOT_READY,()=>{this.$next.hide()}),$(e).on(g.PHASE_CHANGED,()=>{this.renderCurrentPhase()}),e.start()}renderCurrentPhase(){this.$inspector.hide(),this.$content.html(""),this.process.hasNextPhase()||this.$next.hide();let e=this.process.getCurrentPhase();switch(e.getType()){case p.QUESTION:this._renderPhaseQuestion(e);break;case p.ATTEMPT:this._renderPhaseAttempt(e);break;case p.REPORT:this._renderPhaseReport(e);break;default:throw Error("unrecognized phase")}setTimeout(()=>this.updateScrolling(),200),$(this).trigger("change")}_renderPhaseQuestion(e){for(let t of e.questions)new m(t).appendTo(this.$content);"string"==typeof e.examinedHtml&&this.openInspector(e.examinedHtml)}_renderPhaseAttempt(e){let t=new w(e).appendTo(this.$content);$(t).on("change",()=>this.updateScrolling())}_renderPhaseReport(e){new f(e).appendTo(this.$content)}updateScrolling(){this.$content.parent(".slimScrollDiv").size()>0&&(this.$content.parent().replaceWith(this.$content),this.$content.height("auto"));let e=this.$el.innerHeight()-this.$header.outerHeight()-this.$nav.outerHeight();this.$content.slimScroll({height:Math.min(e,this.$content.outerHeight()),color:"rgb(150, 150, 150)",opacity:.3,borderRadius:0,alwaysVisible:!0})}openInspector(e){let t=this.$iframe[0].contentWindow,n=t.document;n.open(),n.write(e),n.close(),setTimeout(()=>{void 0!==t.Timing&&t.Timing.pause(),this.$inspector.show();let e=Math.min(t.document.body.scrollWidth,this.calcMaxIframeWidth());this.$iframe.css({width:e}),this.$iframeOverlay.css({width:e}),$(this).trigger("change")},200)}calcMaxIframeWidth(){return document.documentElement.clientWidth-this.$header.outerWidth()-50-40}}l("\n    .twcheese-debugger {\n        height: 100%;\n        display: flex;\n    }\n\n    .twcheese-debugger a {\n        font-weight: normal;\n        font-size: 12px;\n        color: rgb(63, 156, 214);\n        text-decoration: underline;\n    }\n    .twcheese-debugger a:hover {\n        color: rgb(96, 174, 221);\n    }\n\n    .twcheese-debugger-header {\n        background-color: rgb(56, 56, 56);\n        padding: 9px 20px;\n        font-weight: 700;\n        font-size: 14px;\n        color: rgb(200, 200, 200);\n        cursor: default;\n        min-width: 300px;\n    }\n\n    .twcheese-debugger-process-name {\n        font-weight: normal;\n        font-size: 11px;\n        margin-top: 3px;\n        white-space: nowrap;\n    }\n\n    .twcheese-debugger-content {\n        box-sizing: border-box;\n        padding: 20px;\n    }\n\n    .twcheese-debugger-nav {\n        padding: 20px 10px;\n        height: 20px;\n    }\n\n    .twcheese-debugger-next {\n        width: 0;\n        height: 0;\n        border: 10px solid transparent;\n        cursor: pointer;\n        webkit-filter: brightness(0.7);\n        filter: brightness(0.7);\n    }\n\n    .twcheese-debugger-next {\n        border-left: 20px solid white;\n        float: right;\n    }\n\n    .twcheese-debugger-next:hover {\n        webkit-filter: brightness(1);\n        filter: brightness(1);\n    }\n\n    /* inspector */\n\n    .twcheese-debugger-inspector {\n        position: relative;\n        width: 100%;\n        background-color: rgb(30, 30, 30);\n        line-height: unset;\n    }\n\n    .twcheese-debugger-inspector iframe,\n    .twcheese-debugger-inspector .iframe-overlay {\n        width: 500px;\n        height: calc(100% - 40px);\n        margin: 20px;\n        border: none;\n        overflow: hidden;\n    }\n\n    .twcheese-debugger-inspector .iframe-overlay {\n        position: absolute;\n        top: 0;\n        left: 0;\n        background-color: cyan;\n        opacity: 0.1;\n    }\n\n");class x extends i{constructor(){super(),this.initStructure(),this.watchSelf(),this.isExpandedVert=!1,this.activeMenuItem=null,this.contents={bugReporter:(new v).appendTo(this.$content)},this.watchContents()}initStructure(){this.$el=$(this.createHtml().trim()),this.$menuMain=this.$el.find(".menu-item.main"),this.$mainIcon=this.$menuMain.find(".icon"),this.$menuBug=this.$el.find(".menu-item.bug"),this.$menuGithub=this.$el.find(".menu-item.github"),this.$content=this.$el.find(".twcheese-sidebar-content")}createHtml(){return'\n            <div id="twcheese-sidebar">\n                <div class="twcheese-sidebar-menu">\n                    <div class="menu-item main"><div class="icon"></div></div>\n                    <div class="menu-item bug"><div class="icon"></div></div>\n                    <a class="menu-item github"\n                      href="https://github.com/cheesasaurus/twcheese/releases"\n                      target="_blank"\n                    ><div class="icon"></div></a>\n                </div>\n                <div class="twcheese-sidebar-content"></div>\n            </div>\n        '}watchSelf(){this.$menuMain.on("click",()=>this.toggleExpand()),this.$menuBug.on("click",()=>{this.$menuBug.hasClass("active")?(this.$menuBug.removeClass("active"),this.activeMenuItem=null,this.shrinkHoriz()):(this.contents.bugReporter.startProcessForLastUsedToolIfSensible(),this.$menuBug.addClass("active"),this.activeMenuItem="bug",this.expandHoriz())})}watchContents(){$.each(this.contents,(e,t)=>{$(t).on("change",()=>{this.activeMenuItem&&this.$el.width(this.$el[0].scrollWidth)})})}async toggleExpand(){let e=this.activeMenuItem?200:0,t=200+e;this.spinMainIcon(t),this.isExpandedVert?(this.activeMenuItem&&await this.shrinkHoriz(e),this.shrinkVert(200)):(await this.expandVert(200),this.activeMenuItem&&this.expandHoriz(e))}spinMainIcon(e){$({deg:0}).animate({deg:180},{duration:e,step:e=>{this.$mainIcon.css({transform:"rotate("+e+"deg)"})}})}async expandVert(e){return this.isExpandedVert=!0,new Promise((t,n)=>{let i={duration:e,complete:()=>{this.$menuGithub.show(),t()}};this.$el.animate({height:"100%",easing:"linear"},i)})}shrinkVert(e){this.$menuGithub.hide(),this.isExpandedVert=!1,this.$el.animate({height:"50px"},e)}expandHoriz(e){let t={duration:e};this.$el.animate({width:this.$el[0].scrollWidth},t)}async shrinkHoriz(e){return new Promise((t,n)=>{let i={duration:e,complete:t};this.$el.animate({width:"50px"},i)})}}l(`\n    #twcheese-sidebar {\n        position: fixed;\n        display: inline-block;\n        z-index: 20000;\n        top: 0;\n        left: 0;\n        height: 50px;\n        max-height: 100%;\n        overflow-x: hidden;\n        overflow-y: hidden;\n        width: 50px;\n        max-width: 100%;\n    }\n\n    /* menu **************************************************/\n\n    .twcheese-sidebar-menu {\n        position: relative;\n        display: block;\n        width: 50px;\n        height: 100%;\n        background-color: rgb(51, 51, 51);\n    }\n\n    .twcheese-sidebar-menu.expanded {\n        height: 100%;\n    }\n\n    .twcheese-sidebar-menu .menu-item {\n        position: relative;\n        display: block;\n        box-sizing: border-box;\n        width: 50px;\n        height: 50px;\n        cursor: pointer;\n    }\n\n    .twcheese-sidebar-menu .menu-item .icon {\n        position: absolute;\n        box-sizing: border-box;\n        position: absolute;\n        width: 50px;\n        height: 50px;\n        \n        background-size: 36px 36px;\n        background-repeat: no-repeat;\n        background-position: center;\n    }\n    \n\n    .twcheese-sidebar-menu .menu-item.main {\n        background-color: darkOrange;\n    }\n\n    .twcheese-sidebar-menu .menu-item.main .icon {\n        background-image: url('${a}');\n    }\n    .twcheese-sidebar-menu .menu-item.main:hover .icon {\n        -webkit-filter: brightness(2);\n        filter: brightness(2);\n    }\n\n    .twcheese-sidebar-menu .menu-item.bug .icon {\n        background-image: url('${h}');\n        -webkit-filter: brightness(0.7);\n        filter: brightness(0.7);\n    }\n\n    .twcheese-sidebar-menu .menu-item.github {\n        position: absolute;\n        display: none;\n        bottom: 0;\n        margin-top: 50px;\n    }\n\n    .twcheese-sidebar-menu .menu-item.github .icon {\n        background-image: url('${c}');\n        -webkit-filter: brightness(0.7);\n        filter: brightness(0.7);\n    }\n\n    .twcheese-sidebar-menu .menu-item:hover .icon,\n    .twcheese-sidebar-menu .menu-item.active .icon {\n        -webkit-filter: brightness(1);\n        filter: brightness(1);\n    }\n\n    /* content  **************************************************/\n\n    .twcheese-sidebar-content {\n        position: absolute;\n        display: block;\n        left: 50px;\n        height: 100%;\n        top: 0;\n        background-color: rgb(37, 37, 37);\n        color: rgb(187, 187, 187);\n    }\n\n\n`),TwCheese.registerTool({id:"Sidebar",use:()=>{(new x).appendTo($("body"))},getDebugProcess:()=>null})}]);
//# sourceMappingURL=https://cheesasaurus.github.io/twcheese/dist/tool/setup-only/sourcemaps/Sidebar.min.js.map
